<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Mr. Sigma Boss Stock Game</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #121212;
            color: white;
            text-align: center;
            padding: 20px;
        }
        .stock-container { display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; margin-bottom: 20px; }
        .stock { padding: 10px; background: #1f1f1f; border-radius: 8px; min-width: 150px; }
        button { margin: 5px; padding: 8px 12px; border: none; border-radius: 5px; cursor: pointer; }
        .buy { background: green; color: white; }
        .sell { background: red; color: white; }
        select, input { padding: 5px; margin: 5px; border-radius: 5px; border: none; }
        canvas { background: #000; border-radius: 10px; margin-top: 20px; }
    </style>
</head>
<body>
<h1>ðŸ“ˆ Mr. Sigma Boss Stock Investing Game ðŸ“‰</h1>
<h2>ðŸ’° Balance: $<span id="balance">1000</span></h2>

<label>Diagram history size:</label>
<input type="number" id="history-input" value="30" min="10" max="200">
<button onclick="applyHistorySize()">Apply</button>

<label>ðŸ“Š Select Stock:</label>
<select id="stock-selector" onchange="updateSelectedStock()">
    <option value="ALL">ALL</option>
</select>

<button onclick="toggleDots()">Toggle Dots</button>

<div class="stock-container" id="stocks"></div>

<canvas id="stockChart" width="800" height="400"></canvas>

<script>
    let balance = 1000;
    let historySize = 30;
    let showDots = true;
    let selectedStock = 'ALL';

    const stocks = [
        { name: "SigmaCorp", price: randomPrice(), history: [], shares: 0 },
        { name: "Boss Inc.", price: randomPrice(), history: [], shares: 0 },
        { name: "Alpha Trades", price: randomPrice(), history: [], shares: 0 },
        { name: "Meme Stonks", price: randomPrice(), history: [], shares: 0 },
        { name: "Sigmaâ„¢ AI", price: randomPrice(), history: [], shares: 0 },
        { name: "BrainDamage AI Tech", price: randomPrice(), history: [], shares: 0 },
        { name: "CO2 Pollution", price: randomPrice(), history: [], shares: 0 },
        { name: "OpenAI", price: randomPrice(), history: [], shares: 0 },
        { name: "BUUMGUN", price: randomPrice(), history: [], shares: 0 },
        { name: "Teslaboom", price: randomPrice(), history: [], shares: 0 },
        { name: "Space Z", price: randomPrice(), history: [], shares: 0 },
        { name: "skibidi", price: randomPrice(), history: [], shares: 0 },
        { name: "Weather M", price: randomPrice(), history: [], shares: 0 },
        { name: "CryoLab", price: randomPrice(), history: [], shares: 0 },
        { name: "METAFACE Inc.", price: randomPrice(), history: [], shares: 0 }
    ];

    const ctx = document.getElementById('stockChart').getContext('2d');
    const stockChart = new Chart(ctx, {
        type: 'line',
        data: { labels: [], datasets: [] },
        options: { responsive: true, animation: false, scales: { x: { ticks: { color: 'white' } }, y: { ticks: { color: 'white' } } } }
    });

    function randomPrice() { return (Math.random() * 100 + 10).toFixed(2); }

    function updateStocks() {
        stocks.forEach(stock => {
            let oldPrice = stock.price;
            stock.price = (stock.price * (0.98 + Math.random() * 0.04)).toFixed(2);
            stock.history.push(parseFloat(stock.price));
            if (stock.history.length > historySize) stock.history.shift();
        });
        renderStocks();
        updateChart();
    }

    function renderStocks() {
        const container = document.getElementById('stocks');
        container.innerHTML = '';
        stocks.forEach(stock => {
            const stockDiv = document.createElement('div');
            stockDiv.className = 'stock';
            stockDiv.innerHTML = `<strong>${stock.name}</strong><br>ðŸ’µ $${stock.price}<br>ðŸ“ˆ Shares: ${stock.shares}<br>
                <button class="buy" onclick="buyStock('${stock.name}')">Buy</button>
                <button class="sell" onclick="sellStock('${stock.name}')">Sell</button>`;
            container.appendChild(stockDiv);
        });
    }

    function buyStock(name) {
        const stock = stocks.find(s => s.name === name);
        if (balance >= stock.price) {
            balance -= parseFloat(stock.price);
            stock.shares++;
            document.getElementById('balance').innerText = balance.toFixed(2);
            renderStocks();
        }
    }

    function sellStock(name) {
        const stock = stocks.find(s => s.name === name);
        if (stock.shares > 0) {
            balance += parseFloat(stock.price);
            stock.shares--;
            document.getElementById('balance').innerText = balance.toFixed(2);
            renderStocks();
        }
    }

    function applyHistorySize() {
        historySize = parseInt(document.getElementById('history-input').value);
        stocks.forEach(s => s.history = s.history.slice(-historySize));
    }

    function updateChart() {
        let datasets = [];
        if (selectedStock === 'ALL') {
            datasets = stocks.map(stock => ({
                label: stock.name,
                data: stock.history,
                borderColor: randomColor(),
                borderWidth: 2,
                pointRadius: showDots ? 2 : 0,
                fill: false
            }));
        } else {
            const stock = stocks.find(s => s.name === selectedStock);
            const growing = stock.history[stock.history.length - 1] >= stock.history[0];
            datasets.push({
                label: stock.name,
                data: stock.history,
                backgroundColor: growing ? 'red' : 'green',
                borderColor: growing ? 'red' : 'green',
                type: 'bar', // Block style
                borderWidth: 0
            });
        }
        stockChart.data.labels = Array.from({ length: historySize }, (_, i) => i + 1);
        stockChart.data.datasets = datasets;
        stockChart.update();
    }

    function updateSelectedStock() {
        selectedStock = document.getElementById('stock-selector').value;
        updateChart();
    }

    function toggleDots() {
        showDots = !showDots;
        updateChart();
    }

    function randomColor() { return `hsl(${Math.random() * 360}, 100%, 50%)`; }

    stocks.forEach(stock => { stock.history = Array(historySize).fill(parseFloat(stock.price)); });
    stocks.forEach(stock => document.getElementById('stock-selector').innerHTML += `<option value="${stock.name}">${stock.name}</option>`);
    setInterval(updateStocks, 1000);
</script>
</body>
</html>

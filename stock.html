<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Mr. Sigma Boss Stock Game</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #121212;
            color: white;
            padding: 20px;
            text-align: center;
        }
        .stock-container {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            margin: 20px 0;
        }
        .stock {
            background: #1e1e1e;
            padding: 10px;
            border-radius: 8px;
        }
        button {
            padding: 5px;
            margin-top: 5px;
            width: 100%;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }
        .buy { background: green; color: white; }
        .sell { background: red; color: white; }
        .chart-container {
            background: white;
            border-radius: 10px;
            resize: both;
            overflow: hidden;
            min-width: 300px;
            min-height: 200px;
            width: 600px;
            height: 400px;
            margin: 20px auto;
            position: relative;
        }
        canvas {
            width: 100% !important;
            height: 100% !important;
        }
        select, label, input {
            margin: 10px;
            padding: 5px;
        }
    </style>
</head>
<body>

<h1>ðŸ“ˆ Mr. Sigma Boss Stock Game ðŸ“‰</h1>
<h2>ðŸ’° Balance: $<span id="balance">1000</span></h2>

<label for="stock-select">Select stock:</label>
<select id="stock-select" onchange="updateChart()">
    <option value="ALL">ALL</option>
</select>

<label>
    <input type="checkbox" id="dot-toggle" onchange="updateChart()"> Show Dots
</label>

<div class="stock-container" id="stocks"></div>

<div class="chart-container" id="chart-container">
    <canvas id="stockChart"></canvas>
</div>

<script>
    let balance = 1000;
    let historySize = 20;
    let showDots = false;
    let selectedStock = "ALL";

    const stocks = [
        { name: "SigmaCorp", price: randomPrice(), history: [], shares: 0 },
        { name: "Boss Inc.", price: randomPrice(), history: [], shares: 0 },
        { name: "Alpha Trades", price: randomPrice(), history: [], shares: 0 },
        { name: "Meme Stonks", price: randomPrice(), history: [], shares: 0 },
        { name: "Sigmaâ„¢ AI", price: randomPrice(), history: [], shares: 0 },
        { name: "BrainDamage AI Tech", price: randomPrice(), history: [], shares: 0 },
        { name: "CO2 Pollution", price: randomPrice(), history: [], shares: 0 },
        { name: "OpenAI", price: randomPrice(), history: [], shares: 0 },
        { name: "BUUMGUN", price: randomPrice(), history: [], shares: 0 },
        { name: "Teslaboom", price: randomPrice(), history: [], shares: 0 },
        { name: "Space Z", price: randomPrice(), history: [], shares: 0 },
        { name: "skibidi", price: randomPrice(), history: [], shares: 0 },
        { name: "Weather M", price: randomPrice(), history: [], shares: 0 },
        { name: "CryoLab", price: randomPrice(), history: [], shares: 0 },
        { name: "METAFACE Inc.", price: randomPrice(), history: [], shares: 0 }
    ];

    function randomPrice() {
        return (Math.random() * 100 + 10).toFixed(2);
    }

    function renderStocks() {
        const container = document.getElementById("stocks");
        container.innerHTML = "";
        stocks.forEach((stock, index) => {
            const div = document.createElement("div");
            div.className = "stock";
            div.innerHTML = `
                <h3>${stock.name}</h3>
                <p>ðŸ’² ${stock.price}</p>
                <p>Shares: ${stock.shares}</p>
                <button class="buy" onclick="buyStock(${index})">Buy</button>
                <button class="sell" onclick="sellStock(${index})">Sell</button>
            `;
            container.appendChild(div);
        });
    }

    function updateStocks() {
        stocks.forEach(stock => {
            stock.price = (stock.price * (0.98 + Math.random() * 0.04)).toFixed(2);
            stock.history.push(parseFloat(stock.price));
            if (stock.history.length > historySize) stock.history.shift();
        });
        document.getElementById("balance").innerText = balance.toFixed(2);
        renderStocks();
        updateChart();
    }

    function buyStock(index) {
        const stock = stocks[index];
        if (balance >= stock.price) {
            stock.shares++;
            balance -= parseFloat(stock.price);
        }
    }

    function sellStock(index) {
        const stock = stocks[index];
        if (stock.shares > 0) {
            stock.shares--;
            balance += parseFloat(stock.price); // Fix: Add money on sell
        }
    }

    const ctx = document.getElementById("stockChart").getContext("2d");
    let stockChart = new Chart(ctx, { type: "line", data: {}, options: {} });

    function updateChart() {
        selectedStock = document.getElementById("stock-select").value;
        showDots = document.getElementById("dot-toggle").checked;

        let datasets = [];
        let chartType = "line";
        let bgColor = '#121212';

        if (selectedStock === "ALL") {
            datasets = stocks.map(stock => ({
                label: stock.name,
                borderColor: `rgb(${Math.random()*255}, ${Math.random()*255}, ${Math.random()*255})`,
                data: stock.history,
                fill: false,
                tension: 0.2,
                borderWidth: 2,
                pointRadius: showDots ? 3 : 0
            }));
        } else {
            const stock = stocks.find(s => s.name === selectedStock);
            const isGrowing = stock.history[stock.history.length - 1] >= stock.history[0];
            bgColor = isGrowing ? "#801010" : "#108010";
            chartType = "bar"; // block style
            datasets = [{
                label: stock.name,
                backgroundColor: isGrowing ? "red" : "green",
                data: stock.history
            }];
        }

        document.getElementById("chart-container").style.background = bgColor;
        stockChart.destroy();
        stockChart = new Chart(ctx, {
            type: chartType,
            data: { labels: Array(historySize).fill(''), datasets },
            options: { responsive: true, maintainAspectRatio: false }
        });
    }

    // Init
    stocks.forEach(stock => stock.history = Array(historySize).fill(stock.price));
    const stockSelect = document.getElementById("stock-select");
    stocks.forEach(stock => {
        const option = document.createElement("option");
        option.value = stock.name;
        option.innerText = stock.name;
        stockSelect.appendChild(option);
    });

    setInterval(updateStocks, 1000);
    renderStocks();
    updateChart();
</script>

</body>
</html>

